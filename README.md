## 블록체인의 확장성과 이더리움 2.0

> 이더리움 2.0 은 기존 이더리움 1.0 이 가지고 있던 여러 문제점들을 해결해 줄 것으로 기대를 모으고 있다. 무엇 보다 평균 15 TPS 정도에 불과한 처리 용량을 대폭 향상시킬 수 있을 것으로 기대된다.
 
PoS(Proof of Stake) 합의 알고리즘의 적용으로 기존 PoW(Proof of Work) 대비 빠른 블록 생성이 가능해 지며, 샤딩을 적용하여 기존 이더리움 1.0 에서 전체 노드가 참여하던 블록 검증 작업을 샤드 단위로 분산하여 처리하므로써 트랜잭션 처리 용량의 개선을 이루어 낼 수 있을 것으로 보인다. 
 
이와 함께 영지식 증명(ZK-SNARK) 기술을 통해 트랜잭션의 익명성 보장이 가능해짐으로써 프라이버시를 강화 할 수 있을 것으로 기대된다.

### 합의 알고리즘

> 블록체인의 합의 알고리즘은 분산된 노드에서 발생한 트랜잭션의 처리 순서를 결정하여 각각의 노드의 상태가 파편화 되지 않고 전체 블록체인이 하나의 Global State 를 유지할 수 있게 해주는 역할을 한다. 

이더리움 1.0 은 PoW 방식의 합의 알고리즘을 사용한다. 비트코인에 처음 적용된 PoW 방식의 합의 알고리즘은 지속적으로 합의를 이루어내어 블럭을 생산해 낼 수 있으며 누구나 블록체인 네트워크에 참여해 블록을 생산할 수 있는 공정한 기회가 주워진다는 장점을 가지고 있다. 
 
하지만 이러한 장점에도 불구하고 블록 생성을 위한 작업 증명 과정에 과도한 자원의 소비를 필요로 하며 생성된 블록의 확정에 오랜 시간이 소요되고 소위 'Mining Farm' 으로 불리는 전문 채굴 업체 등의 등장으로 공정한 블록 생산 기회가 사라지는 등 의 문제점을 드러내게 되었다. 이러한 문제들을 해결하기 위해서 이더리움 2.0 은 PoS 방식의 합의 알고리즘 도입을 결정하였다.
 
PoS 합의 알고리즘은 크게 "Chain-based PoS" 와 "BFT-Style PoS" 두가지 타입으로 분류 할 수 있다. 
 
Chain-Based PoS 합의 알고리즘은 의사난수(Pseudo Random) 방식을 이용하여 각 시간대(Time slot) 별로 하나의 다음 블록을 생성할 권한을 하나의 검증자에게 부여한 후 블록을 생성하게한다. 이렇게 생성된 블록은 반드시 하나의 이전 블록과 연결되어 있어야 한다. 대부분의 경우 이전 블록은 블록 생성 시점에서 가장 긴 체인의 마지막 블록이며 이러한 방식으로 시간이 흐름에 따라 대부분의 새로운 블록이 하나의 메인 체인에 수렴하게 된다.

BFT-Style PoS 합의 알고리즘은 무작위(Random) 하게 다음 블록을 제안할 검증자들을 선정한 후 모든 검증자들이 참여하는 다중(Multi-round) 투표 절차를 거쳐 하나의 다음 블록을 선정한다. Chain-Based PoS 합의 알고리즘과의 가장 큰 차이점은 다음 블록 선정은 블록 단위로 이루어지며 해당 블록과 연결된 Chain 의 길이와는 상관이 없다는 점이다. 이더리움 2.0 의 Casper PoS 합의 알고리즘은 일부 수정된 BFT-Style PoS 합의 알고리즘을 따른다. 
 
Casper 로 명명된 이더리움 2.0 의 PoS 합의 알고리즘은 네트워크에 일정 금액 이상의 이더를 예치(Stake)한 검증자(Validator) 들 중 무작위로 선정된 검증자가 다음 블럭을 생성하고 다른 검증자들에 의해 검증 후 투표에 의해 선정된 경우 체인에 반영되는 방식으로 운영된다. 이때 각 검증자의 투표의 영향력(Voting Power) 는 네트워크에 예치한 금액에 비례하여 증가한다. 또한 검증자들이 규칙을 어기거나 악의적인 행동을 할 경우 벌칙(Penalty)를 부여받게 되어 예치한 이더가 감소하게 된다. 이러한 장치들은 검증자들은 새로운 합의 알고리즘을 보다 안정적으로 운영되도록 만들어 준다.

이더리움 2.0 의 새로운 Casper PoS 합의 알고리즘은 기존 이더리움 1.0 의 PoW 합의 알고리즘 대비 자원 효율적이며 중앙집중화를 완화해 줄 수 있으며 이더리움 2.0 의 또다른 주요 기능인 샤딩과 상호 작용하여 이더리움의 확장성을 향상할 수 있는 기능을 제공한다.

### 대용량 블록체인 트랜잭션 처리
> 블록체인 시스템에는 확장성 트릴레마(Scalability, Trilemma) 문제가 존재한다. 확장성 트릴레마란 블록체인 시스템이 확장성(Scalability), 탈중앙화(Decentralization) 그리고 보안성(Security) 을 모두 확보 할 수 없다는 문제점이다. 세가지 특성 두가지 특성을 확보하면 나머지 하나는 포기할 수 밖에 없다는 것이다.이더리움 2.0 은 블록체인의 확장성 트릴레마의 해결책으로 샤딩을 제안한다.

현재 대부부분의 블록체인 시스템은 각각의 노드가 전체 네트워크의 상태 정보를 저장하고 있으며 네트워크로 전송된 모든 트랜잭션을 처리한다. 이는 블록체인 시스템에 보안성을 제공하는 반면 확정성을 저해한다.

블록체인 시스템에 샤딩을 적용하게 되면 한 블록체인에서 모든 트랜잭션을 처리하지 않고 보다 작고 빠른 샤드 체인에서 트랜잭션들을 나누어 병렬로 처리하는 것이 가능해지며 이를 통해 확장성을 향상시킬 수 있다.

이더리움 2.0 의 샤딩은 언뜻 이더리움 1.0 의 확장성 향상 방안 중 하나였던 플라즈마와 유사해 보인다. 샤딩과 플라즈마 모두 메인 체인과 메인 체인에 연결된 차일드 체인(샤딩의 경우 샤드 체인)에서 트랜잭션 처리를 담당한다는 공통점을 가지고 있다 하지만 본질적인 차이점을 가지고 있다. 

오프체인(레이어 2) 솔루션이 적용된 플라즈마 체인은 메인 체인과 독립된 블록체인 이다. 따라서 플라즈마 체인에 문제가 생기더라도 메인 체인은 영향을 받지 않을 수 있다. 

반면 이더리움 2.0 의 샤드 체인은 메인 체인인 비콘 체인과 긴밀하게 연결되어 있는 온체인(레이어 2) 솔루션이라고 할 수 있다. 따라서 샤드 체인에 문제가 생기게 되면 이는 메인 체인의 문제라고 볼 수 있다.

이더리움 2.0 샤딩의 또다른 특징은 새로운 PoS 합의 알고리즘인 Casper 와 긴밀하게 상호 작용한다는 점이다.

### 이더리움 트랜잭션 파리이버시 보장
- ZK-Snark
- 영지시 증명(ZKP, Zero-knowlege Proofs)
